@import "../common/stylus/shared"

// variables: rolltemplates
$subheader_bg = $sf_rich_black // formerly #23222b
$template_bg = lighten($subheader_bg, 10%) // formerly #33323c
$result_bg = $sf_rich_black // formerly #403f4b
$template_border = 1px solid $sf_rich_black
$strong_hit_color = $sf_ui_blue
$weak_hit_color = $sf_ui_purple
$miss_color = $sf_ui_red
$template_padding = 0.7em 1em

$color_fg_roll_body = $color_fg
$color_fg_roll_body_alt = $color_fg_fade
$color_bg_roll_body = $color_bg

// $color_fg_roll_body = $color_bg
// $color_fg_roll_body_alt = $color_bg_fade
// $color_bg_roll_body = $sf_black

// r20's padding on parent of roll container; can be negated by setting negative margins
$r20_padding_right = 10px
$r20_padding_bottom = 7px
$r20_padding_left = 45px

tplMargin($margin = 0px)
  margin-top 6px + $margin
  margin-right -1 * ($r20_padding_right - $margin)
  margin-bottom -1 * ($r20_padding_bottom - $margin)
  margin-left -1 * ($r20_padding_left - $margin)

// $border_strong_hit = 2px solid $strong_hit_color
// $border_weak_hit = 2px solid $weak_hit_color
// $border_miss = 2px solid $miss_color
resultRow(border = $template_border)
  border border
  background $result_bg

subBase()
  text-align left
  font-weight 700

nameBase(align)
  text-align align
  // font-variant-caps all-small-caps
  text-transform uppercase
  font-weight bold

rollContainer()
  bodyTextLg()
  tplMargin()
  line-height 1
  border 0
  // &:last-child
  //   border solid $sf_rich_black
  //   border-bottom-width 5px

inlineRoll()
  display inline-block
  width 2ch
  height 2ch
  padding 0
  border 0
  display flex
  align-items center
  align-content center
  justify-items center
  justify-content center
  background transparent
  text-align center
  font-family "Exo"

outcomeBase($bgcolor)
  display flex
  flex-flow row
  justify-content left
  headerTextSm()
  gap 0.5ch
  &:before
    align-self stretch
    width 1em
    border-radius 1em
    background-color $bgcolor
    content " "
    margin -0.2em 0

html
  font-size 16px
body
  background-color green !important
.characterviewer > .nav.nav-tabs > li > a
  size 1em



.sheet-rolltemplate-oracle, .sheet-rolltemplate-ironsworn_move, .sheet-rolltemplate-progress_roll, .sheet-rolltemplate-momentum_burn, .sheet-rolltemplate-alert,  .sheet-rolltemplate-starforged_progress, .sheet-rolltemplate-starforged_moves, .sheet-rolltemplate-starforged_oracles
  > .sheet-roll-container
    colorThemeLight()
    rollContainer()
    .sheet-header, .sheet-result-row, *
      line-height 1
    .sheet-i18n-text
      display contents
    .sheet-header
      colorThemeDark()
      background-image url("https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/raster/header-background-left.jpg")
      background-size cover
      background-position left
      headerText()
      subBase(0.35em 0.5em)
      font-size 1.25em
      line-height 1
      position relative
      display grid
      gap 0.25em
      border-bottom-right-radius 0.5em
      margin-right 10px
      padding $template_padding
      padding-bottom 0
      min-height @font-size*@line-height*2
      .sheet-surtitle, .sheet-subtitle
        line-height 1
        font-size 1em
        footerText()
        color $color_bg_fade
        width max-content
        grid-column 1
      &:before
        grid-column 2
        grid-row 1 / -1
    .sheet-title
      align-self end
      line-height 0.7
    .sheet-starforged-icon-action-roll
      iconBehind($icon.1d6, 4px)
      &:before
        color $color_fg_roll_body_alt
        right 0
        top 0
        mask-position right
    .sheet-result-body, .sheet-alert
      padding $template_padding
    .sheet-roll-outcome
      padding 0.5em
    a[href^="!"]
      display inline-block
      padding 5px
      width 100%
      border none
      background-color transparent
      color $color_bg
      text-align center
      text-transform uppercase
      font-weight bold
    .sheet-total
      color $color_fg_roll_body
      border-radius 50%
      padding 0
      // .fullfail
      //   border 2px solid $miss_color
      // .fullcrit
      //   border 2px solid $strong_hit_color
    .sheet-result-row
      display flex
      justify-content space-between
      align-items center
    .sheet-die-cancel
      &:before
        content ""
        height inherit
        width inherit
        background:
          linear-gradient(to top left,
            transparent 0%,
            transparent calc(50% - 0.8px),
            $color_danger 50%,
            transparent calc(50% + 0.8px),
            transparent 100%),
          linear-gradient(to top right,
            transparent 0%,
            transparent calc(50% - 0.8px),
            $color_danger 50%,
            transparent calc(50% + 0.8px),
            transparent 100%)
    .inlinerollresult
      border 0
      inlineRoll()
    .sheet-action-die, .sheet-challenge-dice
      position relative
      display flex
      align-items center
      align-content center
      justify-items center
      justify-content center
      textOutline($color_bg_roll_body, 2px)
      // text-shadow 0px 0px 5px $color_bg_roll_body, 0px 0px 5px $color_bg_roll_body, 0px 0px 5px $color_bg_roll_body
      font-color $color_fg
      font-weight 700
      & > .inlinerollresult
        display flex
        align-items center
        align-content center
        justify-items center
        justify-content center
        border 0
        &:before
          color $color_fg_roll_body_alt
    .sheet-action-die
      > .inlinerollresult
        iconBehind($icon.1d6,0.8em)
        &:before
          mask-origin border-box
    .sheet-challenge-dice
      display flex
      gap 1ch
      > .inlinerollresult
        iconBehind($icon.1d10,0.8em)
        &:before
          mask-origin border-box
      .fullfail:before
        // border 2px solid $strong_hit_color
        color $strong_hit_color

      .fullcrit:before
        // border 2px solid $miss_color
        color $miss_color

    .sheet-roll-outcome
      resultRow()

    .sheet-footer //- consider as 'floating' thing w/ margin like callout boxes?
      colorThemeDark()
      .sheet-roll-outcome
        &.sheet-strong-hit-match
          subBase(0)
          outcomeBase($strong_hit_color)

        &.sheet-strong-hit
          subBase(0)
          outcomeBase($strong_hit_color)

        &.sheet-weak-hit
          subBase(0)
          outcomeBase($weak_hit_color)

        &.sheet-miss
          subBase(0)
          outcomeBase($miss_color)

        &.sheet-miss-match
          subBase(0)
          outcomeBase($miss_color)

    .sheet-btn
      padding 0
      $btnPadding = 0.75ch

      &:before
        all initial

      &.sheet-strong-hit, &.sheet-strong-hit-match
        > a[href^="~"]
          btn($color_bg, $color_cta, $btnPadding)
          border-color currentColor

      &.sheet-weak-hit
        > a[href^="~"]
          btn($color_bg, $sf_ui_purple, $btnPadding)
          border-color currentColor


    .sheet-result-body
      color $color_fg_roll_body
      background-color $color_bg_roll_body
      display flex
      flex-direction column
      gap 0.75em

    .sheet-alert
      margin 0.2em 0.3em
      width auto
      border-radius 1em

    .userscript-tcat
      font-weight 700

    .sheet-momentum-title

    .sheet-roll-button
      justify-content center
      margin 0.2em
      border-radius 0.4em
      background #5e5d6f

      interactiveHover(#9290ad)

@import "./oracle/oracle-roll-templates"
@import "./move/move-roll-templates"