include ./container
include ./oracle-table

mixin movePreviewFactory(move, options)
  +container(move, options)
    .rules-text!=move.Text
    if move.Oracle
      .move-oracle-container
        if move.Name === 'Ask the Oracle'
          //- TODO: resolve this so it pulls AtA properly
        else
          - var singleOracle = oracles.find(group => { return group.Name === 'Move' }).Oracles.find(oracle => { return oracle.Name === move.Name })
          +oracleTable(singleOracle)

mixin movePreview(move, options, visibility=false)
  if visibility==true
    div(class=`${move.id} move-visible move-preview`)
      +moveContent(move, options)
  else
    div(class=`${move.id} showhide move-preview`)
      +moveContent(move, options)

mixin moveContent(move, options)
  if options.no_title
    div
  else
    div.move-title=move.Name
  - const statCheck = move.Triggers.find(trigger => { return trigger["Stat Options"] })
  if move['Progress Move']
    +rollLabel
      +moveProgressRollBtn(move, 'hide-element')
  else if statCheck
    +rollLabel
      +moveActionRollBtn(move, 'hide-element')
  .move-description=move.Text
  .oracle-footer.move-page-footer=move.page

mixin container(move, options = false)
  if options.visibility
    +movePreview(move, options, true)
      block
  else
    input(type='radio' name='attr_move_preview' class=`${move.id} hide-element` value=move.id)
    +movePreview(move, options, false)
      block