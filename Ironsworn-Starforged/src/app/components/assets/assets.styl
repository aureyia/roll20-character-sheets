.page-assets
  display flex
  flex-flow column
  gap 1em

  .repcontainer[data-groupname="repeating_assets"]
    display flex
    flex-flow row wrap
    justify-content space-around
    align-content flex-start
    gap 1em
    display flex
    flex-flow row wrap
    justify-content space-evenly
    padding 0
    order 1

    .repitem
      width max-content
      height max-content

$asset_width = 20em // original: 320px
$inch = ($asset_width / 2.5) // pixels per inch
$point = ($inch / 72) // pixels per point
$pica = ($inch / 6) // pixels per pica
$icon_width = ($asset_width / 5)
$icon_height = hexWidthToHeightPointy($icon_width)

// (0.5 * $inch)

.asset-container
  display inline-block
  width $asset_width

.asset-card
  border-width 1 * $point
  border-style solid
  border-color $sf_ui_gray_dark
  column-gap (2 * $point)
  background-position top right, top 1.02em right 1.09em
  // background-position top right, top 1em right (1em + @border-width)
  position relative
  display grid
  // (0.125*$inch)-(1*$point) // offset to account for border width
  box-sizing border-box
  padding 1em 0.9em 1em 1em
  width $asset_width // 320px
  height 3.5 * $inch // 448px
  background-origin border-box
  background-size 0.95 * $inch auto, $icon_width auto
  background-repeat no-repeat
  grid-template-areas "header ." "body body" "footer footer"
  grid-template-columns 1fr $icon_width // 1/5 of the width
  grid-template-rows minmax($icon_height, max-content) 1fr max-content
  .asset-header
    grid-area header
    display grid
    grid-auto-flow row
    grid-template-rows max-content max-content
    grid-auto-rows max-content
    align-items center
  .asset-type, .asset-name
    stdFont("Exo")
    text-align left
    text-transform uppercase
    // margin-bottom 2*$point
  .asset-abilities, .asset-description
    bodyTextSm()
    font-size 90%
  .asset-name
    height 9.25 * $point // we want height 16px
    font-weight 800
    font-size 1.3125 * 9.25 * $point
    line-height 9.25 * $point
    word-spacing 0
    max-width 12.5ch
    // smarter way would involve calculating from background width, but we're only really sure of its height
  .asset-type
    height 5.75 * $point
    font-weight 600
    font-size 1.3125 * 5.75 * $point
    line-height 5.75 * $point
  .asset-textinput, .asset-select
    display flex
    margin 0
    padding 0
    width stretch
    width -moz-available
    border-bottom 1 * $point solid black
    // height 5.35*$point
    // line-height 5.35*$point
    font-size 1.3125 * 5.35 * $point
    cursor pointer
    // grid-area input
    box-sizing border-box;
    align-items end
    line-height 1
    span
      align-self end
      width max-content
      height min-content
      color $sf_ui_gray_dark

      stdFont("Exo")

      text-transform uppercase
      // margin-bottom 2*$point
      font-weight 600
      line-height 1
      white-space nowrap

    input[type=text], select
      stdFont("Encode Sans Condensed")
      margin 0
      width stretch
      width -moz-available
      border none
      background transparent
      font-weight 500
      align-self end
      padding 0 0 0 0.25em
      height stretch
      height -moz-available
    option
      padding 0

  .asset-abilities, .asset-description
    p, ul, li
      bodyTextSm()
    li
      margin 0
  .asset-abilities
    display flex
    flex-flow column
    grid-area body
    gap 0.25em // 2*$point
    .asset-ability
      // gap 4.125 * $point
      gap 0.3em
      display grid
      grid-auto-placement row
      grid-template-columns max-content 1fr
      .asset-textinput
        grid-column 2
      span.i18n-text
        display block

      // 12 points from left edge of bullet to left edge of ability text
      ul li
        margin 2*$point 0
        padding 0

      input[type="checkbox"]
        grid-column 1
        flex-grow 0
        flex-shrink 0
        align-self start
        justify-self start
        hexCheckbox(1em)
        margin-top 0.075em
        // no top margin - highest point lines up with bottom of icon
        // margin-left 1 * $point // sits 10pts from edge

.asset-counter
  grid-area footer
  width 5ch
  align-self end
  justify-self end
  text-align center

.resource-meter
  display flex
  flex-direction row-reverse
  justify-content flex-end
  font-weight 700
  font-family "Exo", sans-serif
  transition 0.5s ease
  // height of numbers: 6.5pt
  // height of small labels: 5.35 (same as input label)
  grid-area footer
  button
    order -1
    width max-content
    margin-left auto
    width 2em
  .resource-meter-box
    display flex
    flex-direction column
    justify-content center
    align-items center
    margin 0
    margin-right -1.3 * $point
    padding 0
    border none
    cursor pointer
    position relative
    height max-content
    width max-content
    color $color_fg
    background-color $color_bg
    clip-path $hexagon_pointy
    z-index 0
    span
      font-size (0.125 * $inch / (math(3, sqrt) / 2))

    // background-image url("https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/ux/hex-meter-box-unchecked.svg")
    // background-position center
    // background-size contain
    // background-repeat no-repeat
    // mask-image url("https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/ux/hex-meter-box-checked.svg")
    // mask-position center
    // mask-repeat no-repeat
    // mask-size contain
    input[type="radio"]
      border 0
      z-index -1
      hexCheckbox(0.25 * $inch, "https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/ux/hex-meter-box.svg")
      &:hover, &:checked
        + span
          color $color_bg
    span
      position absolute
      top 0
      right 0
      bottom 0
      left 0
      display flex
      align-items center
      justify-content center

for $key, $data in $assetTypes
  $color = $data.Color
  .asset-card.{$key}
    .asset-type, .resource-meter .resource-meter-box
      color unquote($color)

for $key, $data in $assets
  $assetType = $data['asset-type']
  $name = $data.Name
  .asset-card.{$key}
    background-image url("https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/asset-bg/" + $assetType + ".svg"), url("https://raw.githubusercontent.com/aureyia/roll20-character-sheets/starforged-ui-components/Ironsworn-Starforged/assets/icons/" + $key + ".svg")
  input[type=hidden].asset-picker:not([value={$key}])
    ~ .asset-card.{$key}
      display none
  input[type=hidden].asset-picker[value={$key}] + input.asset-picker
    display none

  input[type=hidden].asset-picker:not([value=custom])
    ~ .custom
      display none
  input[type=hidden].asset-picker[value=custom] + input.asset-picker
    display none